<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Collapsible Tree Example</title>
  <script src="https://unpkg.com/cytoscape/dist/cytoscape.min.js"></script>
  <script src="https://unpkg.com/cytoscape-expand-collapse/cytoscape-expand-collapse.js"></script>
  <link rel="stylesheet" href="style.css">
  <style>
    body { margin: 0; }
    #cy { width: 100vw; height: 100vh; display: block; }
  </style>
</head>
<body>
  <div id="cy"></div>

  <script>
    fetch('tree.json')
      .then(res => res.json())
      .then(elements => {
        const cy = cytoscape({
          container: document.getElementById('cy'),
          elements: elements,
          layout: {
            name: 'breadthfirst',
            directed: true,
            orientation: 'vertical', // children below parent
            padding: 20,
            spacingFactor: 1.5
          },
          style: [
            {
              selector: 'node',
              style: {
                'label': 'data(id)',
                'background-color': '#4a90e2',
                'text-valign': 'center',
                'color': '#fff',
                'width': 'label',
                'height': 'label',
                'padding': '10px'
              }
            },
            {
              selector: ':parent',
              style: {
                'background-opacity': 0.1,
                'border-width': 2,
                'border-color': '#333'
              }
            },
            {
              selector: 'edge',
              style: {
                'width': 2,
                'line-color': '#555',
                'target-arrow-shape': 'triangle',
                'target-arrow-color': '#555',
                'curve-style': 'bezier'
              }
            }
          ]
        });

        // Enable expand/collapse
        const api = cy.expandCollapse({
          layoutBy: null, // keep layout static
          animate: false,
          fisheye: false,
          undoable: false
        });

        cy.on('tap', 'node', evt => {
          const node = evt.target;
          if (node.isParent()) {
            api.isCollapsed(node) ? api.expand(node) : api.collapse(node);
          }
        });

        cy.nodes().lock(); // static positions
      });
  </script>
</body>
</html>
